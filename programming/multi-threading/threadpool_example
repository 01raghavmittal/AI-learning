from concurrent.futures import ThreadPoolExecutor, as_completed
import time
import random

def call_api(task_id):
    print(f"üîπ Task {task_id} -> API call started")
    time.sleep(random.uniform(1, 3))  # simulate network delay

    if random.choice([True, False]):  # randomly fail some tasks
        raise Exception(f"‚ùå Task {task_id} API failed")

    print(f"‚úÖ Task {task_id} -> API success")
    return f"Result from task {task_id}"

# Simulate 5 tasks
tasks = [f"T{i}" for i in range(1, 6)]

results = []
errors = []

with ThreadPoolExecutor(max_workers=3) as executor:
    futures = {executor.submit(call_api, t): t for t in tasks}

    for future in as_completed(futures):
        task_name = futures[future]
        try:
            result = future.result()  # waits for that task
            results.append(result)
        except Exception as e:
            errors.append(str(e))

print("\n‚úÖ Successful results:", results)
print("‚ùå Errors:", errors)
